# Task 12: LLM Grounded Answer Synthesis

## Goal

Use LLM to produce user-friendly answers while preserving strict evidence grounding and citations.

## Scope

- Add optional LLM answer synthesis step to `POST /v1/ask`.
- Build prompt template from retrieved chunks with stable citation IDs.
- Enforce output contract requiring claim-to-citation mapping.
- Keep deterministic fallback when grounding is insufficient.

## Deliverables

- Ask service mode switch (`deterministic`, `llm_grounded`).
- Prompt and schema assets for grounded answer generation.
- Output validator that rejects uncited claims.
- Citation-preserving markdown renderer for final response.

## Acceptance Criteria

- `POST /v1/ask` can return natural language answer generated by LLM.
- Every factual claim is linked to at least one returned citation.
- Unsupported or uncited claims are dropped or converted to explicit uncertainty.
- Existing deterministic behavior remains available by config.

## Quality Gates

- Unit tests for claim/citation validation pipeline.
- Regression tests for fallback behavior with weak evidence.
- Prompt injection tests to verify source-grounding is not bypassed.
